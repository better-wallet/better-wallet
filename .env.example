# Better Wallet Environment Configuration
# Copy this file to .env and fill in the values

# ===========================================
# Required Configuration
# ===========================================

# PostgreSQL Configuration
POSTGRES_DSN=postgres://user:pass@localhost:5432/bw?sslmode=disable

# For docker-compose, set these instead:
# POSTGRES_USER=bwuser
# POSTGRES_PASSWORD=your-secure-password-here
# POSTGRES_DB=better_wallet

# Master key for encrypting wallet keys (required)
# Generate with: openssl rand -hex 32
KMS_LOCAL_MASTER_KEY=your-32-byte-master-key

# ===========================================
# Server Configuration
# ===========================================

PORT=8080
VERSION=1.0.0

# EVM RPC URL (optional - needed for transaction broadcasting)
# RPC_URL=https://mainnet.infura.io/v3/YOUR_PROJECT_ID

# CORS allowed origins (comma-separated)
# ALLOWED_ORIGINS=https://your-dashboard.com,https://localhost:3000

# Rate limiting
RATE_LIMIT_ENABLED=true
RATE_LIMIT_RPS=100
RATE_LIMIT_BURST=200

# ===========================================
# Key Execution Backend
# ===========================================

# Key Execution Backend: "kms" or "tee"
EXECUTION_BACKEND=kms

# KMS Backend Configuration
# The KMS backend uses a pluggable provider architecture, allowing self-hosted
# users to choose their preferred key management solution.
#
# Supported providers:
#   - "local"    : Local AES-GCM encryption with a master key (default, simple deployments)
#   - "aws-kms"  : AWS KMS - uses AWS SDK default credential chain
#   - "vault"    : HashiCorp Vault Transit engine
#
# Future providers:
#   - "gcp-kms"       : GCP Cloud KMS
#   - "azure-keyvault": Azure Key Vault
#
KMS_PROVIDER=local

# AWS KMS provider config (when KMS_PROVIDER=aws-kms)
# Uses AWS SDK default credential chain: env vars (AWS_ACCESS_KEY_ID, AWS_SECRET_ACCESS_KEY),
# shared config (~/.aws/credentials), IAM role, etc.
# KMS_AWS_KEY_ID=arn:aws:kms:us-east-1:123456789:key/your-key-id
# KMS_AWS_REGION=us-east-1

# HashiCorp Vault provider config (when KMS_PROVIDER=vault)
# Requires Transit secrets engine enabled: vault secrets enable transit
# Create encryption key: vault write -f transit/keys/wallet-encryption-key
# KMS_VAULT_ADDRESS=https://vault.example.com:8200
# KMS_VAULT_TOKEN=s.your-vault-token
# KMS_VAULT_TRANSIT_KEY=wallet-encryption-key

# ===========================================
# TEE Backend Configuration (if EXECUTION_BACKEND=tee)
# ===========================================

# The TEE backend uses a pluggable platform architecture, allowing self-hosted
# users to choose their preferred TEE provider.
#
# Supported platforms:
#   - "dev"        : Development mode using TCP (connects to localhost:TEE_VSOCK_PORT)
#   - "aws-nitro"  : AWS Nitro Enclave using vsock (Linux only)
#
# Future platforms:
#   - "azure-sgx"  : Azure SGX enclaves
#   - "gcp-confidential" : GCP Confidential VMs
#
# TEE_PLATFORM=dev                         # TEE platform (default: dev)
# TEE_VSOCK_PORT=5000                      # Enclave port (default: 5000)
# TEE_MASTER_KEY_HEX=your-32-byte-hex-key  # Master key for encrypting auth shares
# TEE_ATTESTATION_REQUIRED=false           # Require attestation verification
#
# For aws-nitro platform:
# TEE_VSOCK_CID=3                          # Enclave CID (assigned by Nitro, required)

# ===========================================
# Monitoring (optional docker-compose profile)
# ===========================================

# Prometheus port
PROMETHEUS_PORT=9090

# Grafana credentials (required if using monitoring profile)
GRAFANA_USER=admin
# GRAFANA_PASSWORD=your-grafana-password
GRAFANA_PORT=3001
